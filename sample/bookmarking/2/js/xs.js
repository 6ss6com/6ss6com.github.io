(function(){var e={};e.xs={};e.xs.cookie={get:function(k){var h=document.cookie.split("; ");var n=[],f=[],o=[],g;for(i=0;i<h.length;i++){g=h[i].split("=");if(g[0].indexOf("_divide_")>0){o[g[0]]=(g[1]||"")}else{if(g[0]!=""){f[i]=[g[0],g[1]||""]}}}for(i=0;i<f.length;i++){if(f[i]){if(f[i][1].substr(0,8)!="^divide|"){n[f[i][0]]=unescape(f[i][1])}else{var m=f[i][1].indexOf("$"),l=f[i][1].substring(8,m);n[f[i][0]]=f[i][1].substring(m+1);for(j=1;j<l;j++){n[f[i][0]]+=o[f[i][0]+"_divide_"+j]}n[f[i][0]]=unescape(n[f[i][0]])}}}if(k){return n[k]}else{return n}},set:function(g,p,h,q,k,f,m){if(!m){var p=escape(p)}if(!g||!p){return false}if(g==""||p==""){return false}if(h){if(/^[0-9]+$/.test(h)){var n=new Date();h=new Date(n.getTime()+h*1000).toGMTString()}else{if(!/^wed, \d{2} \w{3} \d{4} \d{2}\:\d{2}\:\d{2} GMT$/.test(h)){h=undefined}}}if(g.indexOf("_divide_")<1&&!m){this.del(g,q,k)}var l=g+"="+p+";"+((h)?" expires="+h+";":"")+((q)?"path="+q+";":"")+((k)?"domain="+k+";":"")+((f&&f!=0)?"secure":"");if(l.length<4096){document.cookie=l}else{var o=Math.floor(p.length/3800)+1;for(i=0;i<o;i++){if(i==0){this.Set(g,"^divide|"+o+"$"+p.substr(0,3800),h,q,k,f,true)}else{this.Set(g+"_divide_"+i,p.substr(i*3800,3800),h,q,k,f,true)}}}return true},del:function(g,k,h){if(!g){return false}if(g==""){return false}if(!this.get(g)){return false}if(escape(this.get(g)).length>3800){var f=Math.floor(escape(this.get(g)).length/3800)+1;for(i=1;i<f;i++){document.cookie=g+"_divide_"+i+"=;"+((k)?"path="+k+";":"")+((h)?"domain="+h+";":"")+"expires=Thu, 01-Jan-1970 00:00:01 GMT;"}}document.cookie=g+"=;"+((k)?"path="+k+";":"")+((h)?"domain="+h+";":"")+"expires=Thu, 01-Jan-1970 00:00:01 GMT;";return true}};var c={_H_XS_COOKIE:"hao_xs_history",showReg:/\bshow\b/,hiddenReg:/\bhidden\b/,showClass:"show",hiddenClass:"hidden",historyList:$("history_list"),hiddenFavTitle:$("fav_title"),hiddenFavLinks:$("fav_links"),init:function(){this.favsiteSpans=[];var h=$("favsites").getElementsByTagName("span");for(var g=13,f=h.length;g<f;g++){this.favsiteSpans.push(h[g])}this.favsitesSwitch();this.initHistoryEvent();this.historySwitch();this.showFirstHistory();this.refreshHistory()},favsitesSwitch:function(){var h=$("favsites_switch"),f=this;addEventListener(h,"click",bind(function(k){if(h.getAttribute("status")==="collapse"){toggle(f.hiddenFavTitle,f.hiddenReg,f.showClass);toggle(f.hiddenFavLinks,f.hiddenReg,f.showClass);toggle(h,"collapse-sites","expand-sites");h.setAttribute("status","expanded");h.innerHTML="收起";h.parentNode.className=h.parentNode.className.replace(/ie6nimei/g,"");e.xs.cookie.set("fav_status","expanded",999999999,"/")}else{toggle(f.hiddenFavTitle,f.showReg,f.hiddenClass);toggle(f.hiddenFavLinks,f.showReg,f.hiddenClass);toggle(h,"expand-sites","collapse-sites");h.setAttribute("status","collapse");h.innerHTML="更多";h.parentNode.className=h.parentNode.className.replace(/^\s+|\s+$/g,"")+" ie6nimei";e.xs.cookie.set("fav_status","collapse",999999999,"/")}preventDefault(getEvent(k))},f),false);if(e.xs.cookie.get("fav_status")==="expanded"){if(document.createEvent){var g=document.createEvent("MouseEvents")||document.createEventObject();g.bubbles=true;g.cancelable=true;g.initEvent("click",true,true);h.dispatchEvent(g)}else{var g=document.createEventObject();g.bubbles=true;g.cancelable=true;h.fireEvent("onclick",g)}}},historySwitch:function(){var h=$("all_history"),f=$("one_history"),k=$("history_expand"),l=$("history_collapse"),g=this;addEventListener(k,"mouseover",bind(function(m){this.showAllHistory(f,h)},g),false);addEventListener(h,"mouseout",bind(function(n){n=getEvent(n);var m;if(n.currentTarget){m=n.relatedTarget}else{m=n.toElement}if(!(m===h||m.parentNode===h||m.parentNode.parentNode===h||m.parentNode.parentNode.parentNode===h)){this.showOneHistory(f,h)}},g),false);addEventListener(document.body,"mouseover",bind(function(m){var n=getTarget(getEvent(m));if(n===document.body){this.showOneHistory(f,h)}},g),false)},showAllHistory:function(f,g){toggle(f,this.showReg,this.hiddenClass);toggle(g,this.hiddenReg,this.showClass)},showOneHistory:function(f,g){toggle(g,this.showReg,this.hiddenClass);toggle(f,this.hiddenReg,this.showClass)},refreshHistory:function(){if(!e.xs.cookie.get(c._H_XS_COOKIE)){var g=$("clear-historys");g.innerHTML="暂无浏览记录";g.style.color="#666";g.style.textDecoration="none"}else{var g=$("clear-historys");g.innerHTML="清空记录";g.style.color=""}var l=this.getHistoryValue(c._H_XS_COOKIE),k=[],n,h;if(l){if((l=l.split("&")).length>0){for(var m=0,f=l.length;m<f;m++){n=l[m].split(",");h="";h+='<li class="history-item clearfix"'+(m===0?' style="margin-top:5px;"':"")+'><a title="删除" href="javascript:void(0);" class="delete-history"></a><a class="history-title" href="'+n[1].split("|")[0]+'" target="_blank">'+(n[0].length>9?n[0].substr(0,9)+"…":n[0])+"</a></li>";k.push(h)}this.historyList.innerHTML=k.join("")}}else{this.historyList.innerHTML='<li style="height: 28px;line-height:28px;margin:0;padding: 0 0 0 20px;">暂无浏览记录</li>'}this.showFirstHistory()},showFirstHistory:function(){var k=$("first_history"),f=this.getHistoryValue(c._H_XS_COOKIE),h=$("no_record");if(f){if((f=f.split("&")).length>0){k.style.display="";var g=f[0].split(",");k.innerHTML=g[0].length>7?g[0].substr(0,7)+"…":g[0];k.href=g[1].split("|")[0];h.style.display="none";return}}k.style.display="none";h.style.display=""},initHistoryEvent:function(){var m=getElementsByClassName($("data_list"),"history-cookie"),l=this,h,g=[getElementsByClassName(document,"frees"),getElementsByClassName(document,"ends"),getElementsByClassName(document,"girls")];g.push(m);for(var k=0,f=g.length;k<f;k++){Arr.forEach(g[k],function(n){addEventListener(n,"click",bind(function(p){var o=e.xs.cookie.get(c._H_XS_COOKIE);if(typeof o=="string"){o=o.split(";")[0].split("&");h=Arr.indexOfCookie(o,n.title.replace(/^\s+|\s+$/g,"")+","+n.href.replace(/^\s+|\s+$/g,""));if(h===-1){o.unshift(n.title.replace(/^\s+|\s+$/g,"")+","+n.href.replace(/^\s+|\s+$/g,"")+"|"+new Date().getTime());if(o.length>5){o.splice(5,1)}}else{o.splice(h,1);o.unshift(n.title.replace(/^\s+|\s+$/g,"")+","+n.href.replace(/^\s+|\s+$/g,"")+"|"+new Date().getTime())}e.xs.cookie.set(c._H_XS_COOKIE,o.join("&"),"999999999","/")}else{e.xs.cookie.set(c._H_XS_COOKIE,n.title.replace(/^\s+|\s+$/g,"")+","+n.href.replace(/^\s+|\s+$/g,"")+"|"+new Date().getTime(),"999999999","/")}this.refreshHistory()},l),false)})}addEventListener($("history_list"),"click",bind(function(p){var q=getTarget(getEvent((p)));if(q.className==="history-title"){var n=e.xs.cookie.get(c._H_XS_COOKIE);n=n.split(";")[0].split("&");var o=Arr.indexOfCookie(n,q.innerHTML+","+q.href);n.splice(o,1);n.unshift(q.innerHTML+","+q.href+"|"+new Date().getTime());e.xs.cookie.set(c._H_XS_COOKIE,n.join("&"),"999999999","/");this.refreshHistory()}},l),false);addEventListener(this.historyList,"click",bind(function(s){var t=getTarget(getEvent(s));if(t.nodeType&&t.nodeName.toLowerCase()==="a"&&t.className.indexOf("delete-history")>-1){var o=t.parentNode,u,r,n,q;while((n=t.nextSibling)!=null&&n.nodeType!==1){}u=n.innerHTML;r=n.href;var p=this.getHistoryValue(c._H_XS_COOKIE).split("&");p.splice(Arr.indexOfCookie(p,u+","+r),1);if(p.length===0){e.xs.cookie.del(c._H_XS_COOKIE,"/")}else{e.xs.cookie.set(c._H_XS_COOKIE,p.join("&"),"999999999","/")}this.refreshHistory()}},l),false);addEventListener($("clear-historys"),"click",bind(function(o){e.xs.cookie.del(c._H_XS_COOKIE,"/");this.refreshHistory();var n=$("clear-historys");n.innerHTML="暂无浏览记录";n.style.color="#666";n.style.textDecoration="none"},l),false)},getHistoryValue:function(g){var h=e.xs.cookie.get(g),k=null,f;if(typeof h==="string"){f=h.indexOf(";");k=h.substring(0,f===-1?h.length:f)}return k},getHistoryValuePro:function(h){var k=e.xs.cookie.get(h),g=null,f;if(typeof k==="string"){f=k.indexOf(";");g=f===-1?"":k.substring(f)}return g},initPageGoEvent:function(){var h=$("go"),l=$("pageNum"),g=this,f=parseInt(h.getAttribute("count")),k;addEventListener(h,"click",bind(function(m){k=parseInt(l.value);if(!/^[1-9]\d*$/.test(k)){alert("请输入正确的页码");preventDefault(getEvent(m));return}if(k<1){k=1}if(k>f){k=f}location.href=h.getAttribute("href_prefix")+k},g),false);addEventListener(l,"keyup",bind(function(m){m=getEvent(m);if(m.keyCode!==13){return}k=parseInt(l.value);if(!/^[1-9]\d*$/.test(k)){alert("请输入正确的页码");preventDefault(getEvent(m));return}if(k<1){k=1}if(k>f){k=f}location.href=h.getAttribute("href_prefix")+k},g),false)},calculateTimeInterval:function(h,f){var k=parseInt((f-h)/1000);var g;if((g=parseInt(k/60))<60){return(g+1)+"分钟前"}else{if((g=parseInt(g/60))<24){return g+"小时前"}else{if((g)=parseInt(g/24)<10){return g+"天前"}else{return"很久以前"}}}}};c.init();var b={send:function(m){var l=new Date().getTime(),k="https://www.hao123.com/images/track.gif",g="img_"+l,f="page=hao123-xs&level=2&";for(var h in m){f+=encodeURIComponent(h)+"="+encodeURIComponent(m[h])+"&"}window[g]=new Image();window[g].onload=window[g].onerror=function(){window[g]=null};window[g].src=k+"?"+f+"r="+l}};b.send({type:"access"});Arr.forEach($("favsites").getElementsByTagName("a"),function(f){addEventListener(f,"mousedown",function(g){b.send({type:"favsites",name:f.innerHTML,url:f.getAttribute("href")})},false)});Arr.forEach($("filter_lx").getElementsByTagName("a"),function(f){addEventListener(f,"mousedown",function(g){b.send({type:"filter_lx",name:f.innerHTML,url:f.getAttribute("href")})},false)},false);Arr.forEach($("filter_sf").getElementsByTagName("a"),function(f){addEventListener(f,"mousedown",function(g){b.send({type:"filter_sf",name:f.innerHTML,url:f.getAttribute("href")})},false)},false);var a=$("data_list");Arr.forEach(getElementsByClassName(a,"poster"),function(f){addEventListener(f,"mousedown",function(g){b.send({type:"poster",url:f.getAttribute("href")})},false)});Arr.forEach(getElementsByClassName(a,"title-link"),function(f){addEventListener(f,"mousedown",function(g){b.send({type:"title",url:f.getAttribute("href"),title:f.innerHTML})},false)});Arr.forEach(getElementsByClassName(a,"author-link"),function(f){addEventListener(f,"mousedown",function(g){b.send({type:"author",name:f.innerHTML,url:f.getAttribute("href")})},false)});var d=$("page");Arr.forEach(getElementsByClassName(d,"previous_page"),function(f){addEventListener(f,"mousedown",function(g){b.send({type:"previous_page"})},false)});Arr.forEach(getElementsByClassName(d,"next_page"),function(f){addEventListener(f,"mousedown",function(g){b.send({type:"next_page"})},false)});Arr.forEach(d.getElementsByTagName("a"),function(f){if(!f.className&&f.getAttribute("id")!="go"){addEventListener(f,"mousedown",function(g){b.send({type:"fanye",page:f.innerHTML,url:f.getAttribute("href")})},false)}});Arr.forEach(getElementsByClassName(getElementsByClassName(document,"sidebar")[0],"history"),function(f){Arr.forEach(f.getElementsByTagName("a"),function(g){if(g.className==="history-title"){addEventListener(g,"mousedown",function(h){b.send({type:"read_history",title:g.innerHTML})},false)}})});Arr.forEach(getElementsByClassName(document,"frees"),function(f){addEventListener(f,"mousedown",function(g){b.send({type:"frees",title:f.innerHTML.replace(/^\s+|\s+$/g,""),category:"免费小说推荐",url:f.getAttribute("href")})},false)});Arr.forEach(getElementsByClassName(document,"ends"),function(f){addEventListener(f,"mousedown",function(g){b.send({type:"ends",title:f.innerHTML.replace(/^\s+|\s+$/g,""),category:"完结小说推荐",url:f.getAttribute("href")})},false)});Arr.forEach(getElementsByClassName(document,"girls"),function(f){addEventListener(f,"mousedown",function(g){b.send({type:"girls",title:f.innerHTML.replace(/^\s+|\s+$/g,""),category:"女生小说推荐",url:f.getAttribute("href")})},false)})})();