function fnInitComTool(g,b){var j=g;var h=b[j.attr("sub_toolkit")]==undefined?"":b[j.attr("sub_toolkit")];var a=0;if(h==""){return}$.each(h,function(y,t){var n=t.type;var v;var r=$("<li/>");if(n=="text"){a=a+1;v=$(".txt_tool_list",j);var k=$('<div class="tool_title clearfix" />');var u='<a href=" '+t.href+'" class="visited" target="_blank" >'+t.title+'</a><span class="'+t.status+'"></span>';k.html(u);r.addClass("txt_item").attr({tool_id:y}).html('<div class="operate_add"></div>').prepend(k).appendTo(v)}if(n=="form"){v=$(".icon_tool_list",j);var x=$('<a class="item_icon_wraper fl visited" href="'+t.href+'" target="_blank" />').html('<span class="icon_wrapper"></span><img class="item_icon" height="32" width="32" src="'+t.bg+'"/>');var m=$('<form class="des_content fl" />');var z=$('<div class="clearfix" />');z.html('<a class="tool_title fl visited" title="'+t.title+'" href="'+t.href+'" target="_blank" > '+t.title+' </a><span class="'+t.status+'"></span>');var i=$("<div />");var w;var l=t.param.split(",");var s=t.hiddenParam!=undefined?t.hiddenParam.split(","):0;if(l.length==2){w='<input class="des_from fl" type="text" value="'+t.ltip+'" name="'+l[0]+'"defaultTxt="'+t.ltip+'"/><input class="des_to fl" type="text" value="'+t.rtip+'" name="'+l[1]+'"defaultTxt="'+t.rtip+'"/><button class="find fl visited" type="submit"></button>'}if(l.length==1){w='<input class="icon_key fl" type="text" value="" name="'+l[0]+'"defaultTxt=""><button class="find fl visited" type="submit"></button>'}for(var o=0;o<s.length;o++){var B=s[o].split("=")[0];var A=s[o].split("=")[1];w=w+'<input type="hidden" name="'+B+'" value="'+A+'" />'}i.html(w);var q=$('<div class="operate_add">');m.attr({action:t.href,target:"_blank",mehtod:"get"}).append(z).append(i);r.addClass("icon_item").attr({tool_id:y}).append(x).append(m).append(q).appendTo(v)}if(n=="icon"){v=$(".icon_tool_list",j);var x=$('<a class="item_icon_wraper fl visited" href="'+t.href+'" target="_blank"/>').html('<span class="icon_wrapper"></span><img class="item_icon" height="32" width="32" src="'+t.bg+'"/>');var z=$('<div class="icon_status clearfix"/>');z.html('<a class="tool_title fl visited" title="'+t.title+'" href="'+t.href+'" target="_blank" > '+t.title+' </a><span class="'+t.status+'"></span>');var i=$("<div />");var w='<span class="describe"></span>';i.html(w);var q=$('<div class="operate_add">');r.addClass("icon_item").attr({tool_id:y}).append(x).append(z).append(i).append(q).appendTo(v)}if(n=="download"){v=$("ul",j);var p='<a target="_blank" href="'+t.href+'"><span class="item_icon" style="background:url('+t.bg+')"></span><span class="item_text"> '+t.title+'</span></a><a class="overlay" href="'+t.href+'" target="_blank"></a>';r.attr("tool_id",y).html(p).appendTo(v)}});var d=$(".txt_tool_list li",j);var f=(d.length%5)==0?5:(d.length%5);for(var c=d.length-1;c>d.length-1-f;c--){$(d[c]).addClass("last_line")}var e=$(".icon_tool_list li");var f=(e.length%4)==0?4:(e.length%4);for(var c=e.length-1;c>e.length-1-f;c--){$(e[c]).css("margin","0 10px 0px 0")}if($(".icon_tool_list li",j).length==0){$(".icon_tool_list",j).remove();$(".txt_tool_list",j).css("margin","-15px 0 0 0")}}function fnInitAddTool(){var a=$(".all_item_container .operate_add");a.click(function(){var l=this;var k=$(l).parent().attr("tool_id");var c=$(".all_item_container").has(this).attr("sub_toolkit");var h=$("body").attr("top_toolkit");var b=fnGetCookie("hao123_tool_store")||STORETOOL;var e={};var f;var g;var d=false;e.top_toolkit=h;e.sub_toolkit=c;e.tool_id=k;for(var j=0;j<b.length;j++){var i=b[j];if(i.top_toolkit==e.top_toolkit&&i.sub_toolkit==e.sub_toolkit&&i.tool_id==e.tool_id){d=true;break}}if(d){f=$('<div class="tooltip_existed" />');g='<span class="err_tip">我的收藏中已有此应用</span>'}else{b.push(e);fnSetCookie("hao123_tool_store",baidu.json.stringify(b));f=$('<div class="tooltip_succ" />');g='<span class="succ_tip">成功添加到我的收藏</span>'}f.html(g).appendTo($(l).parent());$(l).parent().find(".tool_title").css("borderBottom","1px solid #fff");$(l).parent().removeClass("cur");setTimeout(function(){f.remove();$(l).parent().find(".tool_title").attr("style","")},1000)})}function fnTackToolClick(){var a=$(".visited");a.click(function(){var h=$("body").attr("top_toolkit");var g=$(".all_item_container").has(this).attr("sub_toolkit");var e=$(".all_item_container li").has(this).attr("tool_id");var d=fnGetCookie("hao123_tool_recent")||[];var f={};f.top_toolkit=h;f.sub_toolkit=g;f.tool_id=e;if(d.length==0){d.push(f);fnSetCookie("hao123_tool_recent",baidu.json.stringify(d));return}for(var c=0;c<d.length;c++){var b=d[c];if(b.top_toolkit==f.top_toolkit&&b.sub_toolkit==f.sub_toolkit&&b.tool_id==f.tool_id){d.splice(c,1);break}if(c==9){d.pop();break}if(c==d.length-1){break}}d.unshift(f);fnSetCookie("hao123_tool_recent",baidu.json.stringify(d))});a.mousedown(function(){var e=$("body").attr("top_toolkit");var d=$(".all_item_container").has(this).attr("sub_toolkit");var c=$(".all_item_container li").has(this).attr("tool_id");var b=ALLTOOLDATA[e][d][c].title;UserTrack.send({level:"2",page:pageId,type:"click",toolType:d,title:encodeURIComponent(b)},"https://www.hao123.comm/images/track.gif")})}function fnSoftDownloadTarck(){$('body[top_toolkit="softTool"] .all_item_container a').mousedown(function(){var a=$(" .all_item_container li").has(this).find(".item_text").html();UserTrack.send({level:"2",page:pageId,type:"click",toolType:"soft",title:encodeURIComponent(a)},"https://www.hao123.comm/images/track.gif")})}$(function(){var c=$("body").attr("top_toolkit");var b=ALLTOOLDATA[c];var d=$(".all_item_container");for(var a=0;a<d.length;a++){fnInitComTool($(d[a]),b)}fnInitAddTool();fnTackToolClick();fnSoftDownloadTarck()});